repositories:
- name: backbone
  url: https://helm.digit.org/backbone

templates: 
  backbone: &backbone
    namespace: backbone
    missingFileHandler: Warn

values:
- {{ env "ENV_FILE" }} 
- {{ env "SECRET_FILE" }} 

releases:
- name: cert-manager
  chart: backbone/{{`{{ .Release.Name }}`}}
  namespace: egov
  installed: true
  version: 1.0.0
  disableValidation: true

# - name: minio
#   installed: true
#   chart: ./minio
#   version: 13.3.1
#   <<: *default
#   values:
#     - ./minio/values.yaml

# - name: postgresql
#   installed: true
#   chart: ./postgresql
#   version: 11.9.13
#   <<: *default
#   values:
#     - ./postgresql/values.yaml
#     - global:
#         postgresql:
#           auth:
#             postgresPassword: {{ .Values.secrets.db.password | quote }}
- name: redis
  installed: true
  chart: backbone/{{`{{ .Release.Name }}`}}
  version: 3.0.0
  <<: *default

- name: elasticsearch-master
  chart: backbone/{{`{{ .Release.Name }}`}}
  version: 1.0.0
  <<: *default
  values:
    - secret:
        password: {{ .Values.secrets.elasticsearch.password }}

- name: elasticsearch-data
  chart: backbone/{{`{{ .Release.Name }}`}}
  version: 1.0.0
  <<: *default

- name: kibana
  chart: backbone/{{`{{ .Release.Name }}`}}
  version: 1.0.0
  force: true
  <<: *default
  values:
    - ingress:
        hosts:
          - host: {{ .Values.global.domain }}
            paths:
              - path: /kibana
        tls: 
          - secretName: {{ .Values.global.domain }}-tls-certs
            hosts:
              - {{ .Values.global.domain }}

- name: kafka-kraft
  installed: true
  chart: backbone/{{`{{ .Release.Name }}`}}
  version: 1.0.0
  <<: *default

- name: ingress-nginx
  installed: true
  chart: backbone/{{`{{ .Release.Name }}`}}
  version: 1.0.0
  <<: *default
  values:
    - domain: {{ .Values.global.domain }}

# - name: playground
#   installed: true
#   chart: ./playground
#   version: 0.1.0
#   <<: *default
#   values:
#     - ./playground/values.yaml